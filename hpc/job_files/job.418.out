Defaulting to user installation because normal site-packages is not writeable
Collecting ACSConv@ git+https://github.com/M3DV/ACSConv@95dc860a77e309f010a3d8be1f675e77c7dfeda4 (from -r requirements.txt (line 1))
  Using cached ACSConv-0.1.1-py3-none-any.whl
Requirement already satisfied: annotated-types==0.7.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 2)) (0.7.0)
Requirement already satisfied: contourpy==1.3.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 3)) (1.3.0)
Requirement already satisfied: coral-pytorch==1.4.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 4)) (1.4.0)
Requirement already satisfied: cycler==0.12.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 5)) (0.12.1)
Requirement already satisfied: filelock==3.16.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 6)) (3.16.1)
Requirement already satisfied: fire==0.7.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 7)) (0.7.0)
Requirement already satisfied: fonttools==4.54.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 8)) (4.54.1)
Requirement already satisfied: fsspec==2024.10.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 9)) (2024.10.0)
Requirement already satisfied: imageio==2.36.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 10)) (2.36.0)
Requirement already satisfied: Jinja2==3.1.4 in /opt/itu/condaenvs/pytorch/lib/python3.12/site-packages (from -r requirements.txt (line 11)) (3.1.4)
Requirement already satisfied: joblib==1.4.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 12)) (1.4.2)
Requirement already satisfied: kiwisolver==1.4.7 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 13)) (1.4.7)
Requirement already satisfied: lazy_loader==0.4 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 14)) (0.4)
Requirement already satisfied: MarkupSafe==3.0.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 15)) (3.0.2)
Requirement already satisfied: matplotlib==3.9.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 16)) (3.9.2)
Requirement already satisfied: mpmath==1.3.0 in /opt/itu/condaenvs/pytorch/lib/python3.12/site-packages (from -r requirements.txt (line 17)) (1.3.0)
Requirement already satisfied: networkx==3.4.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 18)) (3.4.2)
Requirement already satisfied: numpy==2.1.3 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 19)) (2.1.3)
Requirement already satisfied: packaging==24.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 20)) (24.2)
Requirement already satisfied: pandas==2.2.3 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 21)) (2.2.3)
Requirement already satisfied: pillow==11.0.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 22)) (11.0.0)
Requirement already satisfied: protobuf==5.28.3 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 23)) (5.28.3)
Requirement already satisfied: pydantic==2.9.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 24)) (2.9.2)
Requirement already satisfied: pydantic_core==2.23.4 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 25)) (2.23.4)
Requirement already satisfied: pydicom==3.0.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 26)) (3.0.1)
Requirement already satisfied: pylidc==0.2.3 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 27)) (0.2.3)
Requirement already satisfied: pyparsing==3.2.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 28)) (3.2.0)
Requirement already satisfied: python-dateutil==2.9.0.post0 in /opt/itu/condaenvs/pytorch/lib/python3.12/site-packages (from -r requirements.txt (line 29)) (2.9.0.post0)
Requirement already satisfied: python-dotenv==1.0.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 30)) (1.0.1)
Requirement already satisfied: pytz==2024.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 31)) (2024.2)
Requirement already satisfied: scikit-image==0.24.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 32)) (0.24.0)
Requirement already satisfied: scikit-learn==1.5.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 33)) (1.5.2)
Requirement already satisfied: scipy==1.14.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 34)) (1.14.1)
Requirement already satisfied: seaborn==0.13.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 35)) (0.13.2)
Requirement already satisfied: six==1.16.0 in /opt/itu/condaenvs/pytorch/lib/python3.12/site-packages (from -r requirements.txt (line 36)) (1.16.0)
Requirement already satisfied: SQLAlchemy==2.0.36 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 37)) (2.0.36)
Requirement already satisfied: sympy==1.13.3 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 38)) (1.13.3)
Requirement already satisfied: tensorboardX==2.6.2.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 39)) (2.6.2.2)
Requirement already satisfied: termcolor==2.5.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 40)) (2.5.0)
Requirement already satisfied: threadpoolctl==3.5.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 41)) (3.5.0)
Requirement already satisfied: tifffile==2024.9.20 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 42)) (2024.9.20)
Requirement already satisfied: torch==2.4.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 43)) (2.4.1)
Requirement already satisfied: torchvision==0.19.1 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 44)) (0.19.1)
Requirement already satisfied: tqdm==4.67.0 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 45)) (4.67.0)
Requirement already satisfied: typing_extensions==4.12.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 46)) (4.12.2)
Requirement already satisfied: tzdata==2024.2 in /home/maxd/.local/lib/python3.12/site-packages (from -r requirements.txt (line 47)) (2024.2)
Requirement already satisfied: setuptools in /opt/itu/condaenvs/pytorch/lib/python3.12/site-packages (from coral-pytorch==1.4.0->-r requirements.txt (line 4)) (75.1.0)
Requirement already satisfied: greenlet!=0.4.17 in /home/maxd/.local/lib/python3.12/site-packages (from SQLAlchemy==2.0.36->-r requirements.txt (line 37)) (3.1.1)
Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.1.105 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.105)
Requirement already satisfied: nvidia-cuda-runtime-cu12==12.1.105 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.105)
Requirement already satisfied: nvidia-cuda-cupti-cu12==12.1.105 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.105)
Requirement already satisfied: nvidia-cudnn-cu12==9.1.0.70 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (9.1.0.70)
Requirement already satisfied: nvidia-cublas-cu12==12.1.3.1 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.3.1)
Requirement already satisfied: nvidia-cufft-cu12==11.0.2.54 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (11.0.2.54)
Requirement already satisfied: nvidia-curand-cu12==10.3.2.106 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (10.3.2.106)
Requirement already satisfied: nvidia-cusolver-cu12==11.4.5.107 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (11.4.5.107)
Requirement already satisfied: nvidia-cusparse-cu12==12.1.0.106 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.0.106)
Requirement already satisfied: nvidia-nccl-cu12==2.20.5 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (2.20.5)
Requirement already satisfied: nvidia-nvtx-cu12==12.1.105 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (12.1.105)
Requirement already satisfied: triton==3.0.0 in /home/maxd/.local/lib/python3.12/site-packages (from torch==2.4.1->-r requirements.txt (line 43)) (3.0.0)
Requirement already satisfied: nvidia-nvjitlink-cu12 in /home/maxd/.local/lib/python3.12/site-packages (from nvidia-cusolver-cu12==11.4.5.107->torch==2.4.1->-r requirements.txt (line 43)) (12.6.77)

A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "/home/maxd/master_thesis/model/train.py", line 19, in <module>
    from sklearn.model_selection import StratifiedGroupKFold
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/__init__.py", line 84, in <module>
    from .base import clone
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/base.py", line 19, in <module>
    from .utils._estimator_html_repr import _HTMLDocumentationLinkMixin, estimator_html_repr
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/__init__.py", line 11, in <module>
    from ._chunking import gen_batches, gen_even_slices
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_chunking.py", line 8, in <module>
    from ._param_validation import Interval, validate_params
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 14, in <module>
    from .validation import _is_arraylike_not_scalar
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/validation.py", line 26, in <module>
    from ..utils._array_api import _asarray_with_order, _is_numpy_namespace, get_namespace
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_array_api.py", line 11, in <module>
    from .fixes import parse_version
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/fixes.py", line 24, in <module>
    import pandas as pd
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/__init__.py", line 26, in <module>
    from pandas.compat import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/compat/__init__.py", line 27, in <module>
    from pandas.compat.pyarrow import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/compat/pyarrow.py", line 8, in <module>
    import pyarrow as pa
  File "/opt/itu/condaenvs/pytorch/lib/python3.12/site-packages/pyarrow/__init__.py", line 65, in <module>
    import pyarrow.lib as _lib
Traceback (most recent call last):
  File "/home/maxd/.local/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py", line 44, in __getattr__
    raise ImportError(msg)
ImportError: 
A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.



A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "/home/maxd/master_thesis/model/train.py", line 19, in <module>
    from sklearn.model_selection import StratifiedGroupKFold
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/__init__.py", line 84, in <module>
    from .base import clone
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/base.py", line 19, in <module>
    from .utils._estimator_html_repr import _HTMLDocumentationLinkMixin, estimator_html_repr
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/__init__.py", line 11, in <module>
    from ._chunking import gen_batches, gen_even_slices
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_chunking.py", line 8, in <module>
    from ._param_validation import Interval, validate_params
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 14, in <module>
    from .validation import _is_arraylike_not_scalar
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/validation.py", line 26, in <module>
    from ..utils._array_api import _asarray_with_order, _is_numpy_namespace, get_namespace
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_array_api.py", line 11, in <module>
    from .fixes import parse_version
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/fixes.py", line 24, in <module>
    import pandas as pd
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/__init__.py", line 49, in <module>
    from pandas.core.api import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/api.py", line 9, in <module>
    from pandas.core.dtypes.dtypes import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/dtypes/dtypes.py", line 24, in <module>
    from pandas._libs import (
  File "/opt/itu/condaenvs/pytorch/lib/python3.12/site-packages/pyarrow/__init__.py", line 65, in <module>
    import pyarrow.lib as _lib
Traceback (most recent call last):
  File "/home/maxd/.local/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py", line 44, in __getattr__
    raise ImportError(msg)
ImportError: 
A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.



A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.

Traceback (most recent call last):  File "/home/maxd/master_thesis/model/train.py", line 19, in <module>
    from sklearn.model_selection import StratifiedGroupKFold
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/__init__.py", line 84, in <module>
    from .base import clone
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/base.py", line 19, in <module>
    from .utils._estimator_html_repr import _HTMLDocumentationLinkMixin, estimator_html_repr
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/__init__.py", line 11, in <module>
    from ._chunking import gen_batches, gen_even_slices
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_chunking.py", line 8, in <module>
    from ._param_validation import Interval, validate_params
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_param_validation.py", line 14, in <module>
    from .validation import _is_arraylike_not_scalar
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/validation.py", line 26, in <module>
    from ..utils._array_api import _asarray_with_order, _is_numpy_namespace, get_namespace
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/_array_api.py", line 11, in <module>
    from .fixes import parse_version
  File "/home/maxd/.local/lib/python3.12/site-packages/sklearn/utils/fixes.py", line 24, in <module>
    import pandas as pd
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/__init__.py", line 49, in <module>
    from pandas.core.api import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/api.py", line 28, in <module>
    from pandas.core.arrays import Categorical
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/arrays/__init__.py", line 1, in <module>
    from pandas.core.arrays.arrow import ArrowExtensionArray
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/arrays/arrow/__init__.py", line 5, in <module>
    from pandas.core.arrays.arrow.array import ArrowExtensionArray
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/arrays/arrow/array.py", line 64, in <module>
    from pandas.core.arrays.masked import BaseMaskedArray
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/arrays/masked.py", line 60, in <module>
    from pandas.core import (
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/core/nanops.py", line 52, in <module>
    bn = import_optional_dependency("bottleneck", errors="warn")
  File "/home/maxd/.local/lib/python3.12/site-packages/pandas/compat/_optional.py", line 135, in import_optional_dependency
    module = importlib.import_module(name)
  File "/opt/itu/condaenvs/pytorch/lib/python3.12/importlib/__init__.py", line 90, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "/opt/itu/condaenvs/pytorch/lib/python3.12/site-packages/bottleneck/__init__.py", line 7, in <module>
    from .move import (move_argmax, move_argmin, move_max, move_mean, move_median,
Traceback (most recent call last):
  File "/home/maxd/.local/lib/python3.12/site-packages/numpy/core/_multiarray_umath.py", line 44, in __getattr__
    raise ImportError(msg)
ImportError: 
A module that was compiled using NumPy 1.x cannot be run in
NumPy 2.1.3 as it may crash. To support both 1.x and 2.x
versions of NumPy, modules must be compiled with NumPy 2.0.
Some module may need to rebuild instead e.g. with 'pybind11>=2.12'.

If you are a user of the module, the easiest solution will be to
downgrade to 'numpy<2' or try to upgrade the affected module.
We expect that some modules will need time to support NumPy 2.


The ``converters`` are currently experimental. It may not support operations including (but not limited to) Functions in ``torch.nn.functional`` that involved data dimension
[INFO|train.py|train_model|L202] 2024-11-11 20:42:11: 
        Training model: context30
        LR: 0.001
        EPOCHS: 100
        BATCH_SIZE: 32
        CONTEXT_WINDOW_SIZE: 30
        CROSS_VALIDATION: False
        ES_PATIENCE: 5
        ES_MIN_DELTA: 0.01

        Output directory: /home/maxd/master_thesis/out/model_runs/context30_1111_2042
        
[INFO|dataset.py|__init__|L150] 2024-11-11 20:42:11: 
LIDC-IDRI dataset loaded successfully with parameters:
IMG_DIM: 30
SEGMENTATION: none
[INFO|train.py|train_model|L233] 2024-11-11 20:42:11: 
Starting Fold 1/5
Epoch:   0%|          | 0/100 [00:00<?, ?it/s]model is on device: cuda:0

Epoch Batches:   0%|          | 0/52 [00:00<?, ?it/s][A
Epoch Batches:   2%|â–         | 1/52 [00:29<24:48, 29.18s/it][A
Epoch Batches:   4%|â–         | 2/52 [01:00<25:26, 30.54s/it][A
Epoch Batches:   6%|â–Œ         | 3/52 [01:25<22:53, 28.04s/it][A
Epoch Batches:   8%|â–Š         | 4/52 [01:59<24:23, 30.49s/it][A
Epoch Batches:  10%|â–‰         | 5/52 [02:27<23:00, 29.37s/it][A
Epoch Batches:  12%|â–ˆâ–        | 6/52 [02:57<22:39, 29.54s/it][A
Epoch Batches:  13%|â–ˆâ–Ž        | 7/52 [03:32<23:37, 31.49s/it][A
Epoch Batches:  15%|â–ˆâ–Œ        | 8/52 [05:38<45:03, 61.44s/it][A
Epoch Batches:  17%|â–ˆâ–‹        | 9/52 [07:41<57:57, 80.86s/it][A
Epoch Batches:  19%|â–ˆâ–‰        | 10/52 [09:45<1:05:46, 93.95s/it][A
Epoch Batches:  21%|â–ˆâ–ˆ        | 11/52 [11:46<1:10:00, 102.45s/it][A
Epoch Batches:  23%|â–ˆâ–ˆâ–Ž       | 12/52 [13:27<1:07:58, 101.97s/it][A